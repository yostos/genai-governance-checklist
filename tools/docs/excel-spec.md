# Excel チェックリスト仕様書

## 1. 文書概要

| 項目 | 内容 |
|------|------|
| ファイル名 | `genai-governance-checklist.xlsx` |
| 生成方法 | Python スクリプト（openpyxl）で `src/ch*.md` から自動生成 |
| シート構成 | 2シート（チェックリスト本体 + サマリー） |
| データ件数 | 全120項目（7章・27節） |
| 用途 | 組織のガイドライン網羅性をセルフチェックする |
| 出力先 | `excel/genai-governance-checklist.xlsx` |

---

## 2. シート1「チェックリスト」

### 2.1 カラム定義

| 列 | カラム名 | 幅(文字) | データ型 | 内容 |
|----|---------|----------|---------|------|
| A | チェック結果 | 12 | ドロップダウン | 対応済 / 一部対応 / 未対応 / 該当なし |
| B | 項目番号 | 8 | テキスト | 例: 1.1.A |
| C | 章 | 5 | 整数 | 章番号（1–7） |
| D | 章タイトル | 28 | テキスト | 例: ガバナンス体制 |
| E | 節 | 6 | テキスト | 例: 1.1 |
| F | 節タイトル | 24 | テキスト | 例: 組織体制・責任 |
| G | 準拠レベル | 14 | テキスト | Required / Recommended / Option |
| H | チェック項目 | 60 | テキスト（折返し） | チェック項目の本文 |
| I | NIST | 5 | テキスト | ○ or 空 |
| J | NIST-GAI | 5 | テキスト | ○ or 空 |
| K | METI | 5 | テキスト | ○ or 空 |
| L | JDLA | 5 | テキスト | ○ or 空 |
| M | IPA | 5 | テキスト | ○ or 空 |
| N | FUJITSU | 5 | テキスト | ○ or 空 |
| O | EU-AIA | 5 | テキスト | ○ or 空 |
| P | 備考 | 30 | テキスト（折返し） | 自由記入メモ |
| Q | 対応状況メモ | 40 | テキスト（折返し） | 対応方針・課題の記録 |

説明・定義例はExcelに含めない
（mdbook本文を参照する運用とする）。

#### 設計判断

- **A列を先頭に配置**: セルフチェックの主操作列を最初に置く。
- **C–F列を分割**: フィルタで章・節単位の絞り込みを可能にする。
- **I–O列を個別列化**: フレームワーク別フィルタを可能にする。
  全角丸印「○」を使用（日本語文書の慣例）。

### 2.2 行構成

| 行 | 内容 |
|----|------|
| 1行目 | タイトル（A1:Q1結合） |
| 2行目 | 記入欄（A2:Q2結合） |
| 3行目 | ヘッダー行（カラム名） |
| 4–123行目 | データ行（120項目） |

- 1行目: 「生成AI利用ガイドライン チェックリスト」
- 2行目: 「組織名: ＿＿＿＿＿　記入者: ＿＿＿＿＿　記入日: ＿＿＿＿年＿＿月＿＿日」

章区切り行は挿入しない（フラットデータ構成）。
章の区別は条件付き書式の背景色で実現する
（オートフィルタとの干渉を回避するため）。

---

## 3. 書式設定

### 3.1 タイトル行（1行目）

| 属性 | 値 |
|------|-----|
| フォント | メイリオ, 16pt, Bold |
| 文字色 | 白 (#FFFFFF) |
| 背景色 | 濃紺 (#1F3864) |
| 行の高さ | 36pt |

### 3.2 記入欄行（2行目）

| 属性 | 値 |
|------|-----|
| フォント | メイリオ, 10pt |
| 文字色 | 黒 (#000000) |
| 背景色 | 薄灰 (#D9E2F3) |
| 行の高さ | 28pt |

### 3.3 ヘッダー行（3行目）

| 属性 | 値 |
|------|-----|
| フォント | メイリオ, 11pt, Bold |
| 文字色 | 白 (#FFFFFF) |
| 背景色 | 濃紺 (#1F3864) |
| 配置 | 水平中央・垂直中央、折り返し有効 |
| 行の高さ | 40pt |
| 罫線 | 全辺: 細実線（白） |

### 3.4 ウィンドウ枠の固定

固定位置: **セル B4**

効果:
- 1–3行目（タイトル + 記入欄 + ヘッダー）が常に表示
- A列（チェック結果）が常に表示

### 3.5 章ごとの行背景色

| 章 | 背景色 | 色名 |
|----|--------|------|
| 1. ガバナンス体制 | #E2EFDA | 薄緑 |
| 2. リスクの特定と評価 | #DEEBF7 | 薄青 |
| 3. 入力データの管理 | #FFF2CC | 薄黄 |
| 4. 出力の管理と利用 | #F2DCDB | 薄紅 |
| 5. 信頼性の確保 | #E2D9F3 | 薄紫 |
| 6. インシデント対応 | #FCE4D6 | 薄橙 |
| 7. ガイドラインとしての完成度 | #D6DCE4 | 薄灰 |

適用範囲: B–O列。
A列はチェック結果の条件付き書式を優先するため除外。

---

## 4. データバリデーション

### A列: チェック結果

| 属性 | 値 |
|------|-----|
| 入力規則 | ドロップダウンリスト |
| 選択肢 | 対応済, 一部対応, 未対応, 該当なし |
| 空白許可 | はい（未記入を許容） |
| エラーメッセージ | 「対応済・一部対応・未対応・該当なしから選択してください」 |

---

## 5. 条件付き書式

### 5.1 A列 — チェック結果

| 値 | 背景色 | 文字色 | 書体 |
|----|--------|--------|------|
| 対応済 | #C6EFCE (薄緑) | #006100 (濃緑) | 通常 |
| 一部対応 | #FFEB9C (薄黄) | #9C6500 (濃橙) | 通常 |
| 未対応 | #FFC7CE (薄赤) | #9C0006 (濃赤) | 通常 |
| 該当なし | #D9D9D9 (薄灰) | #808080 (灰) | 斜体 |

### 5.2 G列 — 準拠レベル

| 値 | 背景色 | 文字色 | 書体 |
|----|--------|--------|------|
| Required | #F4B084 (薄橙) | #843C0C (濃茶) | Bold |
| Recommended | #BDD7EE (薄青) | #1F4E79 (濃紺) | 通常 |
| Option | #E2EFDA (薄緑) | #375623 (濃緑) | 通常 |

### 5.3 I–O列 — 参照タグ

| 条件 | 背景色 | 配置 |
|------|--------|------|
| 値が「○」 | #D6E4F0 (薄青) | 中央 |
| 空 | なし | 中央 |

---

## 6. オートフィルタ

フィルタ範囲: **A3:Q123**（ヘッダー行からデータ最終行まで）

想定フィルタパターン:

1. A列「未対応」のみ → 残タスク確認
2. C列で章番号指定 → 章単位の作業
3. G列「Required」のみ → 最優先項目の確認
4. A列「未対応」+ G列「Required」→ 最緊急項目の特定
5. I–O列で「○」を表示 → フレームワーク別の網羅性確認

---

## 7. シート2「サマリー」

### 7.1 全体サマリー（A1:F8 領域）

タイトル: 「チェック結果 全体サマリー」

| 行 | 内容 | 数式 |
|----|------|------|
| 対応済 | 件数・割合 | `=COUNTIF(チェックリスト!A4:A123,"対応済")` |
| 一部対応 | 件数・割合 | `=COUNTIF(チェックリスト!A4:A123,"一部対応")` |
| 未対応 | 件数・割合 | `=COUNTIF(チェックリスト!A4:A123,"未対応")` |
| 該当なし | 件数・割合 | `=COUNTIF(チェックリスト!A4:A123,"該当なし")` |
| 未記入 | 件数・割合 | `=COUNTBLANK(チェックリスト!A4:A123)` |

割合: 件数 ÷ 120（パーセンテージ、小数点以下1桁）

### 7.2 準拠レベル別サマリー（A10:H16 領域）

タイトル: 「準拠レベル別 チェック結果」

| | 項目数 | 対応済 | 一部対応 | 未対応 | 該当なし | 未記入 | 対応率 |
|--|--------|--------|---------|--------|---------|--------|--------|
| Required | COUNTIFS | … | … | … | … | … | % |
| Recommended | COUNTIFS | … | … | … | … | … | % |
| Option | COUNTIFS | … | … | … | … | … | % |

数式例:
```
=COUNTIFS(チェックリスト!G4:G123,"Required",チェックリスト!A4:A123,"対応済")
```

### 7.3 章別サマリー（A18:I28 領域）

タイトル: 「章別 チェック結果」

各章の行に以下を表示:
- 項目数・対応済・一部対応・未対応・該当なし・未記入・対応率
- **必須対応率**: Required項目のみの対応率（別列）

### 7.4 凡例・使い方ガイド（A30:F40 領域）

以下の内容をテキストで記載:

```
チェック結果の選択基準:
- 対応済:   ガイドラインに該当する内容が記載されている
- 一部対応: 内容は含まれているが不十分、または表現が曖昧
- 未対応:   ガイドラインに該当する記載がない
- 該当なし: 自組織の状況に照らして対応不要と判断した項目

推奨する進め方:
1. まず「Required」項目だけをフィルタで表示し、すべてチェックする
2. 次に「Recommended」項目を確認する
3. 最後に「Option」項目を組織の状況に応じて検討する
4. 「該当なし」とした項目は、備考欄にその理由を記入する
```

### 7.5 サマリーの書式

| 属性 | 値 |
|------|-----|
| タイトル行 | メイリオ, 14pt, Bold, 濃紺背景, 白文字 |
| ヘッダー行 | メイリオ, 10pt, Bold, ダークブルーグレー (#44546A) 背景, 白文字 |
| データ行 | メイリオ, 10pt |
| パーセンテージ | 小数点以下1桁（例: 85.7%） |

### 7.6 サマリーの条件付き書式

対応率セル:

| 条件 | 背景色 | 意味 |
|------|--------|------|
| 100% | #C6EFCE (薄緑) | 全項目対応完了 |
| 80%以上100%未満 | #FFEB9C (薄黄) | おおむね対応 |
| 80%未満 | #FFC7CE (薄赤) | 要対応 |

---

## 8. 印刷設定

### チェックリストシート

| 属性 | 値 |
|------|-----|
| 用紙サイズ | A3 |
| 印刷の向き | 横 |
| 拡大縮小 | シートを1ページの幅に合わせる（横方向のみ） |
| 余白 | 上下左右: 1.5cm |
| ヘッダー印刷 | 左: 文書タイトル、右: ページ番号 |
| フッター印刷 | 中央: Confidential |
| タイトル行 | 1–3行目を各ページに繰り返し印刷 |
| 印刷タイトル列 | A–B列を各ページに繰り返し印刷 |

### サマリーシート

| 属性 | 値 |
|------|-----|
| 用紙サイズ | A4 |
| 印刷の向き | 縦 |
| 拡大縮小 | 1ページに収める |
| 余白 | 上下左右: 2.0cm |

---

## 9. シート保護

| 範囲 | 保護 | 理由 |
|------|------|------|
| A列（チェック結果） | 編集可 | ユーザーが記入する |
| B–O列（チェック項目データ） | 編集不可 | マスターデータ保護 |
| P–Q列（備考・メモ） | 編集可 | ユーザーが記入する |
| サマリーシート全体 | 編集不可 | 数式保護 |

パスワードは設定しない（誤操作防止の位置づけ）。

---

## 10. Python スクリプト設計

### 10.1 ファイル構成

```
tools/
  generate_excel.py    # メインスクリプト
  requirements.txt     # openpyxl>=3.1.0
  docs/
    excel-spec.md      # 本仕様書
```

### 10.2 処理フロー

1. `src/ch01-governance.md` – `src/ch07-document-quality.md` を読込み
2. 正規表現でチェック項目をパース（番号・レベル・テキスト・タグ）
3. openpyxl で Workbook 作成
4. シート1「チェックリスト」構築
   （データ・書式・バリデーション・フィルタ・固定枠・保護）
5. シート2「サマリー」構築
   （集計数式・書式・保護）
6. 印刷設定適用
7. `excel/genai-governance-checklist.xlsx` に保存

### 10.3 パース正規表現

```python
import re

# 項目行
ITEM_PATTERN = re.compile(
    r'^- (\d+\.\d+\.[A-Z])\.\s+'
    r'\[(Required|Recommended|Option)\]\s+'
    r'(.+?)(?:\s+\[.*\])*\s*$'
)

# 参照タグ
TAG_PATTERN = re.compile(
    r'\[(NIST(?:-GAI)?|METI|JDLA|IPA|FUJITSU|EU-AIA)'
    r'(?::[^\]]+)?\]'
)
```

**注意事項**:
- `[NIST: GOVERN 2.3]`（コロン付き）は `NIST` タグとして扱う。
- 説明・定義例はパース不要（Excelに含めない）。

### 10.4 依存パッケージ

```
openpyxl>=3.1.0
```

---

## 11. 互換性・配布

| 項目 | 内容 |
|------|------|
| 出力先 | `excel/genai-governance-checklist.xlsx` |
| 推定サイズ | 50–100KB |
| 対象ソフト | Excel 2016以降, LibreOffice Calc 7以降, Google Sheets |
| 配布方法 | リポジトリに含めてcommitする |

---

## 12. 節の一覧（全27節）

| 節 | タイトル |
|----|---------|
| 1.1 | 組織体制・責任 |
| 1.2 | ポリシー・規程 |
| 1.3 | 教育・研修 |
| 1.4 | 監視・監査 |
| 2.1 | 利用目的・文脈の明確化 |
| 2.2 | リスクの分類と評価 |
| 2.3 | サードパーティリスク |
| 3.1 | 入力禁止情報 |
| 3.2 | データ分類と取り扱い |
| 3.3 | 個人情報保護 |
| 4.1 | 出力の検証義務 |
| 4.2 | 著作権・知的財産 |
| 4.3 | 出力の表示・開示 |
| 4.4 | 品質管理 |
| 5.1 | 正確性・信頼性 |
| 5.2 | 安全性 |
| 5.3 | セキュリティ・レジリエンス |
| 5.4 | 透明性・説明責任 |
| 5.5 | 説明可能性 |
| 5.6 | プライバシー保護 |
| 5.7 | 公平性・バイアス管理 |
| 6.1 | 報告体制 |
| 6.2 | 対応プロセス |
| 6.3 | 記録と改善 |
| 7.1 | 構成・可読性 |
| 7.2 | 実効性 |
| 7.3 | 管理情報 |
